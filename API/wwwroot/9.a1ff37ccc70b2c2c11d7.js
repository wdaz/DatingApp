(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{jkDv:function(e,t,n){"use strict";n.r(t),n.d(t,"AdminModule",(function(){return M}));var s=n("3Pt+"),o=n("PCNd"),c=n("ofXK"),r=n("fXoL"),a=n("44PX"),i=n("8T1h"),b=n("K3ix");function l(e,t){if(1&e&&(r.Qb(0,"div",11),r.Qb(1,"input",12),r.Xb("change",(function(){const e=t.$implicit;return e.checked=!e.checked})),r.Pb(),r.Qb(2,"label"),r.Ac(3),r.Pb(),r.Pb()),2&e){const e=t.$implicit,n=r.Zb();r.xb(1),r.fc("checked",e.checked)("disabled","Admin"===e.name&&"admin"===n.user.username),r.xb(2),r.Bc(e.name)}}let d=(()=>{class e{constructor(e){this.bsModalRef=e,this.updateSelectedRoles=new r.n}ngOnInit(){}updateRoles(){this.updateSelectedRoles.emit(this.roles),this.bsModalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(b.a))},e.\u0275cmp=r.Eb({type:e,selectors:[["app-roles-modal"]],inputs:{updateSelectedRoles:"updateSelectedRoles"},decls:15,vars:2,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body"],["id","rolesForm"],["rolesForm","ngForm"],["class","form-check",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"form-check"],["type","checkbox","value","role.name",1,"form-check-input",3,"checked","disabled","change"]],template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"h4",1),r.Ac(2),r.Pb(),r.Qb(3,"button",2),r.Xb("click",(function(){return t.bsModalRef.hide()})),r.Qb(4,"span",3),r.Ac(5,"\xd7"),r.Pb(),r.Pb(),r.Pb(),r.Qb(6,"div",4),r.Qb(7,"form",5,6),r.yc(9,l,4,3,"div",7),r.Pb(),r.Pb(),r.Qb(10,"div",8),r.Qb(11,"button",9),r.Xb("click",(function(){return t.bsModalRef.hide()})),r.Ac(12," Cancel "),r.Pb(),r.Qb(13,"button",10),r.Xb("click",(function(){return t.updateRoles()})),r.Ac(14," Submit "),r.Pb(),r.Pb()),2&e&&(r.xb(2),r.Cc("Edit roles for ",t.user.username,""),r.xb(7),r.fc("ngForOf",t.roles))},directives:[s.v,s.k,s.l,c.l],styles:[""]}),e})();var u=n("AytR"),m=n("tk/3");let p=(()=>{class e{constructor(e){this.http=e,this.baseUrl=u.a.baseUrl}getUsersWithRoles(){return this.http.get(this.baseUrl+"admin/users-with-roles")}updateUserRoles(e,t){return this.http.post(this.baseUrl+"admin/edit-roles/"+e+"?roles="+t,{})}}return e.\u0275fac=function(t){return new(t||e)(r.Ub(m.b))},e.\u0275prov=r.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function h(e,t){if(1&e){const e=r.Rb();r.Qb(0,"tr"),r.Qb(1,"td"),r.Ac(2),r.Pb(),r.Qb(3,"td"),r.Ac(4),r.Pb(),r.Qb(5,"td"),r.Qb(6,"button",5),r.Xb("click",(function(){r.rc(e);const n=t.$implicit;return r.Zb().openRolesModal(n)})),r.Ac(7," Edit Roles "),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit;r.xb(2),r.Bc(e.username),r.xb(2),r.Bc(e.roles)}}let f=(()=>{class e{constructor(e,t){this.adminService=e,this.modalService=t}ngOnInit(){this.getUsersWithRoles()}getUsersWithRoles(){this.adminService.getUsersWithRoles().subscribe(e=>{this.users=e})}openRolesModal(e){const t={class:"model-dialog-centered",initialState:{user:e,roles:this.getRolesArray(e)}};this.bsModalRef=this.modalService.show(d,t),this.bsModalRef.content.updateSelectedRoles.subscribe(t=>{const n={roles:[...t.filter(e=>!0===e.checked).map(e=>e.name)]};n&&this.adminService.updateUserRoles(e.username,n.roles).subscribe(()=>{e.roles=[...n.roles]})})}getRolesArray(e){const t=[],n=e.roles;return[{name:"Admin",value:"Admin"},{name:"Moderator",value:"Moderator"},{name:"Member",value:"Member"}].forEach(e=>{let s=!1;for(const o of n)if(e.name===o){s=!0,e.checked=!0,t.push(e);break}s||(e.checked=!1,t.push(e))}),t}}return e.\u0275fac=function(t){return new(t||e)(r.Kb(p),r.Kb(b.b))},e.\u0275cmp=r.Eb({type:e,selectors:[["app-user-management"]],decls:9,vars:1,consts:[[1,"row"],[1,"table"],[2,"width","30%"],[2,"width","40%"],[4,"ngFor","ngForOf"],[1,"btn","btn-info",3,"click"]],template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"table",1),r.Qb(2,"tr"),r.Qb(3,"th",2),r.Ac(4,"Username"),r.Pb(),r.Qb(5,"th",3),r.Ac(6,"Active Roles"),r.Pb(),r.Lb(7,"th",2),r.Pb(),r.yc(8,h,8,2,"tr",4),r.Pb(),r.Pb()),2&e&&(r.xb(8),r.fc("ngForOf",t.users))},directives:[c.l],styles:[""]}),e})(),g=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Eb({type:e,selectors:[["app-photo-management"]],decls:2,vars:0,template:function(e,t){1&e&&(r.Qb(0,"p"),r.Ac(1,"photo-management works!"),r.Pb())},styles:[""]}),e})();function P(e,t){1&e&&(r.Qb(0,"tab",4),r.Qb(1,"div",5),r.Lb(2,"app-user-management"),r.Pb(),r.Pb())}function v(e,t){1&e&&(r.Qb(0,"tab",6),r.Qb(1,"div",5),r.Lb(2,"app-photo-management"),r.Pb(),r.Pb())}const R=function(){return["Admin"]},Q=function(){return["Admin","Moderator"]};let k=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Eb({type:e,selectors:[["app-admin-panel"]],decls:6,vars:4,consts:[[1,"tab-panel"],[1,"member-tabset"],["heading","User management",4,"appHasRole"],["heading","Photo management",4,"appHasRole"],["heading","User management"],[1,"container"],["heading","Photo management"]],template:function(e,t){1&e&&(r.Qb(0,"h2"),r.Ac(1,"Admin panel"),r.Pb(),r.Qb(2,"div",0),r.Qb(3,"tabset",1),r.yc(4,P,3,0,"tab",2),r.yc(5,v,3,0,"tab",3),r.Pb(),r.Pb()),2&e&&(r.xb(4),r.fc("appHasRole",r.ic(2,R)),r.xb(1),r.fc("appHasRole",r.ic(3,Q)))},directives:[a.c,i.a,a.a,f,g],styles:[""]}),e})();var y=n("tyNb");const A=[{path:"",component:k}];let w=(()=>{class e{}return e.\u0275mod=r.Ib({type:e}),e.\u0275inj=r.Hb({factory:function(t){return new(t||e)},imports:[[y.f.forChild(A)],y.f]}),e})(),M=(()=>{class e{}return e.\u0275mod=r.Ib({type:e}),e.\u0275inj=r.Hb({factory:function(t){return new(t||e)},imports:[[c.c,s.f,w,o.a]]}),e})()}}]);